# åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºc++å®ç°çš„é«˜æ€§èƒ½åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿï¼Œé‡‡ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•è¿›è¡Œæ•°æ®åˆ†ç‰‡ï¼Œæ”¯æŒHTTPå’ŒgRPCåŒåè®®è®¿é—®ã€‚

## ğŸš€ ç‰¹æ€§

- **åˆ†å¸ƒå¼æ¶æ„**: æ”¯æŒå¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²
- **ä¸€è‡´æ€§å“ˆå¸Œ**: è‡ªåŠ¨æ•°æ®åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡
- **åŒåè®®æ”¯æŒ**: HTTP REST API + gRPCå†…éƒ¨é€šä¿¡
- **å®¹å™¨åŒ–éƒ¨ç½²**: æ”¯æŒDockerå’ŒDocker Compose
- **é«˜æ€§èƒ½**: åŸºäºc++å’ŒgRPCæ„å»º
- **æ˜“äºæ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºæ·»åŠ æ–°åŠŸèƒ½

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- c++
- Docker 
- Docker Compose 

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Client       â”‚    â”‚    Client       â”‚    â”‚    Client       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTP                 â”‚ HTTP                 â”‚ HTTP
          â–¼                      â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Server 1      â”‚â—„â”€â”€â–ºâ”‚   Server 2      â”‚â—„â”€â”€â–ºâ”‚   Server 3      â”‚
â”‚   Port: 9527    â”‚gRPCâ”‚   Port: 9528    â”‚gRPCâ”‚   Port: 9529    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Storage   â”‚ â”‚    â”‚ â”‚   Storage   â”‚ â”‚    â”‚ â”‚   Storage   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

- **gRPC**: é«˜æ€§èƒ½RPCé€šä¿¡
- **ä¸€è‡´æ€§å“ˆå¸Œ**: æ•°æ®åˆ†ç‰‡ç®—æ³•
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### æ–¹å¼ä¸€ï¼šDocker Compose (æ¨è)

1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd demo
```

2. å¯åŠ¨é›†ç¾¤
```bash
docker-compose up --build
```

3. éªŒè¯æœåŠ¡
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:9527/health
curl http://localhost:9528/health
curl http://localhost:9529/health
```


## ğŸ”§ é…ç½®è¯´æ˜

### èŠ‚ç‚¹é…ç½®

| èŠ‚ç‚¹ | HTTPç«¯å£ | gRPCç«¯å£ | ä¸»æœºå |
|------|----------|----------|--------|
| server1 | 9527 | 50051 | server1 |
| server2 | 9528 | 50052 | server2 |
| server3 | 9529 | 50053 | server3 |

### ç¯å¢ƒå˜é‡

- `NODE_ID`: èŠ‚ç‚¹æ ‡è¯†ç¬¦ (server1/server2/server3)

## ğŸ“š API ä½¿ç”¨

### HTTP API

#### è®¾ç½®ç¼“å­˜
```bash
curl -X POST http://localhost:9527 \
  -H "Content-Type: application/json" \
  -d '{"mykey": "myvalue"}'
```

#### è·å–ç¼“å­˜
```bash
curl http://localhost:9527/mykey
```

#### åˆ é™¤ç¼“å­˜
```bash
curl -X DELETE http://localhost:9527/mykey
```

### å“åº”æ ¼å¼

#### æˆåŠŸè®¾ç½®
```json
{"success": true}
```

#### æˆåŠŸè·å–
```json
{"mykey": "myvalue"}
```

#### åˆ é™¤ç»“æœ
```
1
```

#### é”™è¯¯å“åº”
```json
{"detail": "Not Found"}
```

## ğŸ” å·¥ä½œåŸç†

### ä¸€è‡´æ€§å“ˆå¸Œ

1. **è™šæ‹ŸèŠ‚ç‚¹**: æ¯ä¸ªç‰©ç†èŠ‚ç‚¹åˆ›å»º100ä¸ªè™šæ‹ŸèŠ‚ç‚¹
2. **å“ˆå¸Œç¯**: ä½¿ç”¨MD5ç®—æ³•å°†keyæ˜ å°„åˆ°ç¯ä¸Š
3. **èŠ‚ç‚¹é€‰æ‹©**: é¡ºæ—¶é’ˆæŸ¥æ‰¾æœ€è¿‘çš„è™šæ‹ŸèŠ‚ç‚¹
4. **è´Ÿè½½å‡è¡¡**: è™šæ‹ŸèŠ‚ç‚¹ç¡®ä¿æ•°æ®å‡åŒ€åˆ†å¸ƒ

### è¯·æ±‚æµç¨‹

1. å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚åˆ°ä»»æ„èŠ‚ç‚¹
2. èŠ‚ç‚¹æ ¹æ®keyè®¡ç®—å“ˆå¸Œå€¼ç¡®å®šè´Ÿè´£èŠ‚ç‚¹
3. å¦‚æœæ˜¯æœ¬åœ°èŠ‚ç‚¹ï¼Œç›´æ¥å¤„ç†è¯·æ±‚
4. å¦‚æœæ˜¯è¿œç¨‹èŠ‚ç‚¹ï¼Œé€šè¿‡gRPCè½¬å‘è¯·æ±‚
5. è¿”å›å¤„ç†ç»“æœç»™å®¢æˆ·ç«¯

## ğŸ§ª æµ‹è¯•

### åŠŸèƒ½æµ‹è¯•

```bash
# è®¾ç½®æ•°æ®
curl -X POST http://localhost:9527 -H "Content-Type: application/json" -d '{"user:1": {"name": "Alice", "age": 25}}'
# è·å–æ•°æ®
curl http://localhost:9527/user:1
# åˆ é™¤æ•°æ®
curl -X DELETE http://localhost:9527/user:1
# éªŒè¯åˆ é™¤
curl http://localhost:9527/user:1
```

### åˆ†å¸ƒå¼æµ‹è¯•

```bash
# åœ¨ä¸åŒèŠ‚ç‚¹è®¾ç½®æ•°æ®
curl -X POST http://localhost:9527 -H "Content-Type: application/json" -d '{"key1": "value1"}'
curl -X POST http://localhost:9528 -H "Content-Type: application/json" -d '{"key2": "value2"}'
curl -X POST http://localhost:9529 -H "Content-Type: application/json" -d '{"key3": "value3"}'

# ä»ä»»æ„èŠ‚ç‚¹è·å–æ•°æ®
curl http://localhost:9527/key2  # å¯èƒ½ä¼šè½¬å‘åˆ°server2
curl http://localhost:9528/key1  # å¯èƒ½ä¼šè½¬å‘åˆ°server1
curl http://localhost:9529/key3  # æœ¬åœ°å¤„ç†
```

## ğŸ¤ è´¡çŒ®
æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯
MIT License

## ğŸ“ è”ç³»
å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åˆ›å»ºIssueæˆ–è”ç³»ç»´æŠ¤è€…ã€‚